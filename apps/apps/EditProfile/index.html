<!DOCTYPE html>
<html>
<script>
    var SCHEMA_ROOT = "http://schema.org/";

    var PROFILE_URN = "urn:tela:personalDetails";
    var NAME = SCHEMA_ROOT + "name";
    var JOB_TITLE = SCHEMA_ROOT + "jobTitle";
    var EMAIL = SCHEMA_ROOT + "email";
    var TELEPHONE = SCHEMA_ROOT + "telephone";
    var DESCRIPTION = SCHEMA_ROOT + "description";

    function updateProfile() {
        var values = {};
        values[NAME] = document.getElementById("name").value;
        values[JOB_TITLE] = document.getElementById("jobTitle").value;
        values[EMAIL] = document.getElementById("email").value;
        values[TELEPHONE] = document.getElementById("telephone").value;
        values[DESCRIPTION] = document.getElementById("description").value;

        var json = parent.createJsonLdObjectAsString(PROFILE_URN, SCHEMA_ROOT + "Person", values);

        parent.makeRESTRequestWithData("/data?uriToPublish=" + encodeURIComponent(PROFILE_URN), "application/ld+json", json);
    }

    function downloadOwnProfile() {
        parent.makeRESTRequest("/data?uri=" + encodeURIComponent("urn:tela:personalDetails"), function (responseText) {
            populateUserInfo(JSON.parse(responseText)[0]);
        });
    }

    function populateUserInfo(info) {
        var fields = ["name", "jobTitle", "email", "telephone", "description"];

        for (var i = 0; i < fields.length; i++) {
            populateField(fields[i], info);
        }
    }

    function populateField(field, data) {
        if (data != null && data[SCHEMA_ROOT + field]) {
            document.getElementById(field).value = parent.getValueOfJsonLdField(data, SCHEMA_ROOT + field);
        }
    }
</script>
<body onload="downloadOwnProfile()">
<label for="name">{{nameLabel}}</label><input id="name"/><br/>
<label for="jobTitle">{{jobTitleLabel}}</label><input id="jobTitle"/><br/>
<label for="email">{{emailLabel}}</label><input id="email"/><br/>
<label for="telephone">{{telephoneLabel}}</label><input id="telephone"/><br/>
<label for="description">{{descriptionLabel}}</label><input id="description"/><br/>
<button onclick="updateProfile()">{{updateProfile}}</button>
</body>
</html>
